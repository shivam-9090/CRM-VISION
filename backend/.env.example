# Database Configuration
# Connection URL with optional pool parameters
# Format: postgresql://user:password@host:port/database?schema=public&connection_limit=10&pool_timeout=20
DATABASE_URL="postgresql://postgres:1595@localhost:5432/crm_db?schema=public&connection_limit=10&pool_timeout=20"

# Connection Pool Settings
DB_POOL_SIZE=10  # Number of database connections in the pool (default: 10)
DB_POOL_TIMEOUT=20  # Connection timeout in seconds (default: 20)
DB_CONNECTION_LIMIT=10  # Maximum number of connections (default: 10)
DB_POOL_MIN=2  # Minimum connections to keep alive (default: 2)

# Production Pool Recommendations:
# - Small apps (< 100 users): 5-10 connections
# - Medium apps (100-1000 users): 10-20 connections
# - Large apps (> 1000 users): 20-50 connections
# - Calculate: (core_count * 2) + effective_spindle_count
# - PostgreSQL default max_connections = 100

# JWT
JWT_SECRET="CRM_APP_2024_SECURE_JWT_SECRET_KEY_DO_NOT_SHARE"
JWT_EXPIRES_IN=15m  # Access token expiry (15 minutes)
JWT_REFRESH_EXPIRES_IN=7d  # Refresh token expiry (7 days)

# Server Configuration (Cross-Platform Ready)
PORT=3001
NODE_ENV=development

# Frontend URL for CORS (Multiple origins supported)
FRONTEND_URL=http://localhost:3000

# Cross-Platform Configuration Notes:
# - Backend listens on 0.0.0.0:3001 (all network interfaces)
# - CORS configured for local networks (192.168.x.x, 10.x.x.x, 172.x.x.x)
# - Frontend can connect from different machines using workspace IP
# - Firewall may need port 3001 opened for external access

# Network Access:
# Local: http://localhost:3001
# Network: http://[WORKSPACE_IP]:3001 (replace with actual IP)

# Monitoring & Error Tracking
SENTRY_DSN=""  # Get from https://sentry.io (REQUIRED for production)
SENTRY_RELEASE="crm-backend@1.0.0"  # Optional: Release version for tracking
SENTRY_ENABLE_DEV=false  # Optional: Enable Sentry in development (default: false)
HOSTNAME="crm-server"  # Optional: Server identifier for logs

# Email Configuration
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-gmail-app-password"  # Use App Password, not regular password
EMAIL_FROM="your-email@gmail.com"

# Email Queue Configuration (Bull with Redis)
REDIS_EMAIL_QUEUE_DB=2  # Separate Redis database for email queue (0-15)
EMAIL_QUEUE_CONCURRENCY=5  # Number of concurrent email processing jobs
EMAIL_MAX_RETRIES=3  # Maximum retry attempts for failed emails
EMAIL_RETRY_DELAY=5000  # Initial retry delay in milliseconds (exponential backoff)

# Redis Configuration
REDIS_HOST="localhost"  # Or 'redis' for Docker
REDIS_PORT=6379
REDIS_PASSWORD=""  # Optional: Set for production
REDIS_URL="redis://localhost:6379"  # Full Redis connection URL

# Redis Caching Strategy
REDIS_CACHE_ENABLED=true  # Enable/disable caching globally
REDIS_CACHE_TTL_SHORT=300  # 5 minutes - frequently changing data
REDIS_CACHE_TTL_MEDIUM=1800  # 30 minutes - moderate change rate
REDIS_CACHE_TTL_LONG=3600  # 1 hour - rarely changing data
REDIS_CACHE_TTL_DAY=86400  # 24 hours - static/reference data

# Cache Key Prefixes (for organization)
CACHE_PREFIX_DEALS="deals"
CACHE_PREFIX_CONTACTS="contacts"
CACHE_PREFIX_ACTIVITIES="activities"
CACHE_PREFIX_ANALYTICS="analytics"
CACHE_PREFIX_USER="user"

# Cache Performance Settings
REDIS_MAX_MEMORY="256mb"  # Maximum memory for Redis
REDIS_MAX_MEMORY_POLICY="allkeys-lru"  # Eviction policy (LRU recommended)

# Production Security Settings
# In production, ensure:
# 1. JWT_SECRET is at least 64 characters and cryptographically random
# 2. DATABASE_URL points to production database (not localhost)
# 3. SENTRY_DSN is configured for error monitoring
# 4. Email credentials are valid
# 5. All secrets are stored in secure vault (not version controlled)

# Database Backup Configuration
BACKUP_DIR="/backups"  # Directory for backup storage
RETENTION_DAYS=30  # Number of days to keep backups
POSTGRES_CONTAINER="crm-postgres-prod"  # PostgreSQL container name

# AWS S3 Offsite Backup (Optional but Recommended)
S3_BUCKET=""  # AWS S3 bucket for offsite backups
S3_PREFIX="crm-backups"  # S3 prefix for organizing backups
ENABLE_S3_UPLOAD="false"  # Enable automatic S3 uploads (true/false)
AWS_ACCESS_KEY_ID=""  # AWS credentials (if not using IAM roles)
AWS_SECRET_ACCESS_KEY=""  # AWS credentials (if not using IAM roles)
AWS_REGION="us-east-1"  # AWS region for S3 bucket

# Backup Email Notifications (Optional)
ENABLE_EMAIL_ALERTS="false"  # Enable backup status emails (true/false)
ALERT_EMAIL=""  # Email address for backup alerts

